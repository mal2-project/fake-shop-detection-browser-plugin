"use strict";window.browser=function(){return window.msBrowser||window.browser||window.chrome}(),!function(){function a(b,d){return c?void(c.transaction("s").objectStore("s").get(b).onsuccess=function(a){var b=a.target.result&&a.target.result.v||null;d(b)}):void setTimeout(function(){a(b,d)},100)}var b=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!b)return void console.error("indexDB not supported");var c,d={k:"",v:""},e=b.open("d2",1);e.onsuccess=function(){c=this.result},e.onerror=function(a){console.error("indexedDB request error"),console.log(a)},e.onupgradeneeded=function(a){c=null;var b=a.target.result.createObjectStore("s",{keyPath:"k"});b.transaction.oncomplete=function(a){c=a.target.db}},window.ldb={get:a,set:function(a,b){d.k=a,d.v=b,c.transaction("s","readwrite").objectStore("s").put(d)}}}();var $locales=$("[data-locales]");$locales.each(function(a){var b=$locales.eq(a);b.html(window.browser.i18n.getMessage(b.data("locales")))});var $db_info_disabled=$("[data-db-info=\"disabled\"]"),$db_info_disabled_slider=$("[data-db-info=\"disabled-slider\"]"),$db_info_ignore_name=$("#popupInfoIgnoreName"),$db_info_ignore_description=$("#popupInfoIgnoreDescription"),$db_info_ignore_link=$("#popupInfoIgnoreLink"),$db_info_fraud=$("[data-db-info=\"fraud\"]"),$db_info_fraud_name=$("#popupInfoFraudName"),$db_info_fraud_description=$("#popupInfoFraudDescription"),$db_info_fraud_link=$("#popupInfoFraudLink"),$db_info_maybe_fraud=$("[data-db-info=\"maybe-fraud\"]"),$db_info_not_analyzed=$("[data-db-info=\"not-analyzed\"]"),$db_info_not_checked=$("[data-db-info=\"not-checked\"]"),$db_info_successful=$("[data-db-info=\"successful\"]"),$db_info_successful_listing=$("[data-db-info=\"successful-listing\"]"),$db_info_successful_name=$("#popupInfoSuccessfulName"),$db_info_successful_description=$("#popupInfoSuccesfulDescription"),$db_info_successfull_trustmark=$("[data-db-info=\"successful-trustmark\"]"),$db_info_successful_link=$("#popupInfoSuccesfulLink"),$db_info_very_failed=$("[data-db-info=\"failed\"]"),$db_info_working=$("[data-db-info=\"working\"]"),$disabled_plugin=$("[data-locales=\"disableText\"]"),$db_info_very_low=$("[data-db-info=\"very-low\"]"),$db_info_low=$("[data-db-info=\"low\"]"),$db_info_below_avg=$("[data-db-info=\"below-avg\"]"),$db_info_above_avg=$("[data-db-info=\"above-avg\"]"),$db_info_high=$("[data-db-info=\"high\"]"),$db_info_very_high=$("[data-db-info=\"very-high\"]"),$info=$("[data-info]"),$indicator_icon=$("[data-indicator-icon]"),disableSwitch=document.getElementById("disableSwitch");window.browser.tabs.query({active:!0,lastFocusedWindow:!0},function(a){var b=a[0].url,c=window.localStorage.getItem("client_id"),d={method:"POST",body:JSON.stringify({site_baseURL:b,clientID:c}),headers:{"Content-Type":"application/json"},auth_clinetId:1},e=localStorage.getItem("disabled_time"),f=900000;if(!(null==e||e<Date.now()-f))$db_info_working.addClass("hidden"),$disabled_plugin.removeClass("hidden"),$db_info_disabled_slider.removeClass("hidden"),disableSwitch.checked=!1;else if(null!=e&&e>f&&localStorage.removeItem("disable_time"),!b.startsWith("chrome://")&&!b.startsWith("about://")){b=new URL(b),b=b.hostname,b=b.replace("www.","");var g=!1;window.ldb.get("blacklist",function(a){for(var c=JSON.parse(a),e=0;e<c.length&&!1===g;e++)!1===g&&c[e].site_baseURL===b&&($db_info_working.addClass("hidden"),g=!0,$db_info_fraud_link.append("<a target='_blank' href=\""+c[e]["site-information-link"]+"\"> Details zum Fake - Shop</a>"),$db_info_fraud_name.html("Gefunden in: ").append(c[e]["blacklist-name"]),$db_info_fraud_description.append(c[e]["blacklist-description"]),$db_info_fraud.removeClass("hidden"),$indicator_icon.addClass("indicator-fraud"));window.ldb.get("whitelist",function(a){for(var c=JSON.parse(a),e=0;e<c.length&&!1===g;e++)!1===g&&c[e].site_baseURL===b&&($db_info_working.addClass("hidden"),g=!0,"trustmark"===c[e].whitelist_type?($db_info_successful_name.html("Dieser Shop ist Tr\xE4ger des G\xFCtezeichens "),$db_info_successfull_trustmark.removeClass("hidden")):$db_info_successful_name.html("Dieser Shop ist auf "),$db_info_successful_link.append("<a target='_blank' href=\""+c[e]["whitelist-url"]+"\"> Details zur Quelle</a>"),$db_info_successful_name.append(c[e]["whitelist-name"]),"secure_listing"===c[e].whitelist_type&&($db_info_successful_name.append(" angef\xFChrt."),$db_info_successful_listing.removeClass("hidden")),$db_info_successful_description.text(c[e]["whitelist-description"]),"trustmark"===c[e].whitelist_type&&$db_info_successful_description.append("<br><br>Sie befinden sich auf einem vertrauensw\xFCrdigen Onlineshop."),$db_info_successful.removeClass("hidden"),$indicator_icon.addClass("indicator-successful"),$info.removeClass("hidden"));window.ldb.get("ignorelist",function(a){for(var c=JSON.parse(a),e=0;e<c.length&&!1===g;e++)!1===g&&c[e].site_baseURL===b&&(g=!0,$db_info_ignore_link.append("<a target='_blank' href=\""+c[e]["ignorelist-url"]+"\"> Details zur Quelle</a>"),$db_info_ignore_name.html("Gelistet durch: ").append(c[e]["ignorelist-name"]),$db_info_ignore_name.append(c[e]["ignorelist-description"]),$db_info_working.addClass("hidden"),$db_info_disabled.removeClass("hidden"),$indicator_icon.addClass("indicator-ignorelist"),$info.addClass("hidden"));!1===g&&fetch("https://mal2.ait.ac.at/fake-shop-detector/api/1.1/analyze",d).then(function(a){return a.json()}).then(function(a){$db_info_working.addClass("hidden"),400===a.status?($db_info_very_failed.removeClass("hidden"),$indicator_icon.addClass("indicator-not-analyzed"),$info.addClass("hidden")):"very low"===a.risk_score&&"mal2_ai"===a.processor?($db_info_very_low.removeClass("hidden"),$indicator_icon.addClass("indicator-successful")):"low"===a.risk_score&&"mal2_ai"===a.processor?($db_info_low.removeClass("hidden"),$indicator_icon.addClass("indicator-medium")):"below average"===a.risk_score&&"mal2_ai"===a.processor?($db_info_below_avg.removeClass("hidden"),$indicator_icon.addClass("indicator-medium")):"above average"===a.risk_score&&"mal2_ai"===a.processor?($db_info_above_avg.removeClass("hidden"),$indicator_icon.addClass("indicator-medium")):"high"===a.risk_score&&"mal2_ai"===a.processor?($db_info_high.removeClass("hidden"),$indicator_icon.addClass("indicator-medium")):"very high"===a.risk_score&&"mal2_ai"===a.processor?($db_info_very_high.removeClass("hidden"),$indicator_icon.addClass("indicator-fraud")):"whitelist"===a.processor?("trustmark"===a.whitelist_type?$db_info_successful_name.html("Verifiziert durch: "):$db_info_successful_name.html("Gelistet bei: "),$db_info_successful_name.append(a["whitelist-name"]),$db_info_successful_description.text(a["whitelist-description"]),$db_info_successful.removeClass("hidden"),$indicator_icon.addClass("indicator-successful"),$info.removeClass("hidden")):"blacklist"===a.processor?($db_info_fraud_name.html("Gefunden in: ").append(a["blacklist-name"]),$db_info_fraud_description.append(a["blacklist-description"]),$db_info_fraud.removeClass("hidden"),$indicator_icon.addClass("indicator-fraud")):($db_info_disabled.removeClass("hidden"),$indicator_icon.addClass("indicator-disabled"),$info.addClass("hidden"))})})})})}else $db_info_disabled.removeClass("hidden"),$indicator_icon.addClass("indicator-disabled"),$info.addClass("hidden")}),disableSwitch.onclick=function(){!1===disableSwitch.checked?(localStorage.setItem("disabled_time",Date.now()),disableSwitch.checked=!1):localStorage.removeItem("disabled_time"),window.browser.runtime.sendMessage({},function(){window.location.reload(!0)}),window.location.reload(!0)};
//# sourceMappingURL=popup.min.js.map
