{"version":3,"sources":["background.min.js"],"names":["window","n","transaction","objectStore","t","e","o","setTimeout","console","k","v","r","keyPath","get","set","path","disabled_time","Date","url","onsuccess","client_id","Math","target","ldb","headers","auth_clinetId","date","found","disable_offset","one_day","startsWith","data","URL","JSON","whitelist","j","localStorage","getItem","blacklist","i","hostname","replace","tab","command","fetch","ignorelist","json","browser","processor","sendMessage","risk_score","browserAction","parse","checkFakeShop"],"mappings":"aAKAA,MAAM,CAANA,OAAAA,CAAkB,UAAY,CAC5B,MAAOA,CAAAA,MAAM,CAANA,SAAAA,EACLA,MAIJ,CALSA,OAAAA,EAELA,MAAM,CAFR,MADFA,CAAkB,E,CAUU,CAAA,UAAOC,CAAC,QAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAQC,CAAAA,MAAYD,CAAAA,CAAA,CAAA,KAAKE,CAAAA,CAAAA,WAAAA,CAAAA,GAAAA,EAAAA,WAAAA,CAAAA,GAAAA,EAAAA,GAAAA,CAAAA,CAAAA,EAAAA,SAAAA,CAA6C,SAAA,CAAA,CAAA,CAAA,GAAAC,CAAAA,CAAA,CAAAC,CAAA,CAAAA,MAAAA,CAAAA,MAAAA,EAAAA,CAAA,CAAAA,MAAAA,CAAAA,MAAAA,CAAAA,CAAAA,EAAA,IAAA,CAAAC,CAAA,CAAAA,CAAA,CAAlD,CAAA,CAAA,CAAkD,IAAAC,CAAAA,UAAA,CAAA,UAAA,CAAAF,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAA,CAAA,CAA9DH,GAA8D,CAAA,CAAA,GAAAE,CAAAA,CAAA,CAAAJ,MAAA,CAAAA,SAAAA,EAAAA,MAAA,CAAAA,YAAAA,EAAAA,MAAA,CAAAA,eAAAA,EAAAA,MAAA,CAAA,WAAA,CAAA,GAAA,CAAA,CAAA,CAAA,MAAA,KAAAQ,CAAAA,OAAA,CAAAA,KAAAA,CAAA,uBAAAA,CAAA,CAAA,GAAA,CAAA,CAAA,CAAAF,CAAA,CAAA,CAAAG,CAAA,CAAA,EAAA,CAAAC,CAAA,CAAA,EAAA,CAAA,CAAAC,CAAA,CAAAP,CAAA,CAAAA,IAAAA,CAAAA,IAAAA,CAAA,CAAAA,CAAA,CAAAO,CAAA,CAAAA,SAAAA,CAAA,UAAA,CAAAV,CAAA,CAAA,KAAAA,MAAAU,CAAAA,CAAAA,CAAA,CAAAA,OAAAA,CAAA,SAAA,CAAA,CAAA,CAAAH,OAAA,CAAAA,KAAAA,CAAAA,yBAAAA,EAAAA,OAAA,CAAAA,GAAAA,CAAAA,CAAAA,CAAAG,CAAAA,CAAAA,CAAA,CAAAA,eAAAA,CAAA,SAAA,CAAA,CAAA,CAAAV,CAAA,CAAAA,IAAA,CAAA,GAAAG,CAAAA,CAAA,CAAA,CAAA,CAAA,MAAA,CAAA,MAAA,CAAA,iBAAA,CAAA,GAAA,CAAA,CAAAQ,OAAA,CAAA,GAAA,CAAA,CAAA,CAAAR,CAAA,CAAAA,WAAAA,CAAAA,UAAAA,CAAA,SAAA,CAAA,CAAA,CAAAH,CAAA,CAAAI,CAAA,CAAAA,MAAAA,CAAAJ,EAAAG,CAAAO,CAAAA,CAAAX,MAAA,CAAAA,GAAAA,CAAA,CAAAa,GAAA,CAAA,CAAA,CAAAC,GAAA,CAAA,SAAA,CAAA,CAAA,CAAA,CAAA,CAAAR,CAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAL,CAAA,CAAAA,WAAAA,CAAAA,GAAAA,CAAAA,WAAAA,EAAAA,WAAAA,CAAAA,GAAAA,EAAAA,GAAAA,CAAAK,CAAAL,CAAA,CAAA,CAA9E,CAAA,E,CAA6K,QAAA,CAAA,aAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAOvM,GAAA,CAAA,CAAS,IAPmMc,CAAAA,CAACf,CAAN,gCAO9L,CAP4RgB,CAAYR,CAAAA,YAAc,CAAdA,OAAAA,CAAlB,eAAkBA,CAOxS,CAP6VE,IAAEM,IAAAA,EAAAA,CAAA,EAAAA,CAAA,CAAAC,IAAA,CAAFP,GAAEO,SAAFP,GAAd,CAAAQ,CAAA,CAAAA,UAAAA,CAAA,WAAAA,CAAA,EAAA,CAAAA,CAAA,CAAAA,UAAAA,CAAA,UAAAA,CAAcR,CAAd,CAAuCS,CAAAA,CAAF,GAAA,CAAA,GAAA,CAArC,CAAqC,CAArC,CAA2L,GAAFC,CAAAA,CAAA,CAAApB,MAAA,CAAAA,YAAAA,CAAAA,OAAAA,CAAE,WAAFA,CAAE,CAASI,IAAEC,EAAAA,CAAtM,GAA6OO,CAAQ,CAAAS,IAAA,CAAAA,MAAAA,GAAAA,QAAAA,CAAAA,EAAAA,EAAAA,MAAAA,CAAAA,CAAAA,CAART,CAAQS,CAArP,CAAgMrB,MAAA,CAAAA,YAAAA,CAAAA,OAAAA,CAAAA,WAAAA,CAAAA,CAAAA,CAAhM,EAA6PE,GAAAA,CAAAA,CAAF,CAAyB,CAAcG,MAAEiB,CAAhB,MAAA,CAA4BtB,IAAOuB,CAAP,IAAW,CAAX,SAAA,CAAW,CAAA,aAAA,CAAA,CAAA,SAAAH,CAAA,CAAX,CAA5B,CAAuCI,OAAA,CAAA,CAAW,eAAa,kBAAxB,CAAvC,CAAmIC,aAAA,CAAA,GAAnI,CAAvBvB,CACvlBgB,CAAA,CAAAA,CAAA,CAAAA,QAD0V,CAG1VA,CAAA,CAAAA,CAAA,CAAAA,OAAAA,CAAAA,MAAAA,CAH0V,EAG1VA,CAH0V,IAuC5UQ,CAAAA,CAAI,CAAG1B,MAAM,CAANA,YAAAA,CAAAA,OAAAA,CAAb,MAAaA,CAvCqU,CAO/U2B,CAP+U,GAAA,CAUhVC,GAAAA,IAAAA,EAAAA,CAAAA,EAAkBC,SAAxBZ,IAEA,CAFAA,GAAAA,GAAMW,CAAAA,CAGFZ,KAAAA,CAAAA,sEAAAA,CAAAA,CAAAA,IAAAA,CACOc,SAAAA,CAAAA,CAAAA,CAAAA,MAAWC,CAAAA,CAAA,CAAXD,IAAWC,EADlBf,CAAAA,EAAAA,IAAAA,CAEA,SAAA,CAAA,CAAA,CACMhB,MAAIgC,CAAJhC,GAAAA,CAAAA,GAAAA,CAAAA,WAAAA,CAENiC,IAAA,CAAAA,SAAAA,CAFMjC,CAENiC,CAFMjC,CADN,CAoCM,OA/BNkC,CAAAA,CAAA,CAAA,CA+BM,CAASC,CAAC,CAAV,CAAA,CAAgBA,CAAC,CAAGD,CAAS,CAA7B,MAAA,CAAsCC,CAAtC,EAAA,CA9BFf,KAAAA,CAAAA,EAAmBgB,CAAaC,CAAbD,CAAaC,CAAbD,CAAAA,YAAAA,GAAnBhB,CA8BE,GAEIL,CAAI,CAAJA,kCAFJ,CA7BFK,CAAAA,GA6BE,CA5BJA,MAAYC,CAAZD,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAY,CACLgB,IAAAA,CAAAA,CACR,GAAArB,CADQqB,CADK,CAAZhB,CA4BI,CAtCNJ,CAAAA,EAAAA,IAAAA,CAgB6C,KAAA,CAAA,sEAAA,CAAA,CAAA,IAAA,CAHrB,SAAA,CAAA,CAAA,CAAA,MAAAe,CAAAA,CAAA,CAAA,IAAAA,EAGqB,CAAA,EAAA,IAAA,CAClC,SAAA,CAAA,CAAA,CACP/B,MAAA,CAAAA,GAAAA,CAAAA,GAAAA,CAAAA,WAAAA,CAAgBiC,IAAA,CAAAA,SAAAA,CAAhBjC,CAAgBiC,CAAhBjC,CADO,CAJa,GAAAsC,CAAAA,CAAA,CAAA,CAAA,CAOtBb,GAAAA,KAAAA,CAAAA,CAEF,IAAA,GAAAc,CAAAA,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAAD,CAAA,CAAAC,MAAAA,EAAA,KAAA,CAAA,CAAAA,CAAA,EAAA,CAoCkBZ,KAAAA,CAAAA,EAAmBW,CAAS,CAATA,CAAS,CAATA,CAAAA,YAAAA,GAAvB,CApCd,GACUE,CAAV,CAAUA,gCADV,CAEUC,MAAQ,CAARA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CACVC,CAAA,CADUD,EAAAA,CACV,CAoCkBE,OAAO,CAAE,oBApC3B,CADUF,CAFV,CAKed,CAAAA,GALf,CAMY3B,MAEZ,CAFYA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAEZ,CAmCkBe,IAAI,CAAE,CAlCJc,GAAAA,CAkCI,CAnCxB,CAFY7B,CANZ,CAtBAgB,CAgB6C,CAhB7CA,EAAAA,IAAAA,CAqCqB,UAAf,CAoCA4B,KAAK,CAALA,uEAAK,CAALA,CAAAA,IAAAA,CAnCU,SAAA,CAAA,CAAV,CAAA,MAAiBb,CAAAA,CAAGG,CAApB,IAAiBH,EAmCjBa,CAAAA,EAAAA,IAAAA,CAlCMjB,SAAAA,CAAAA,CAAmBO,CACrBnB,MAAO,CAAPA,GAAAA,CAAAA,GAAAA,CAAAA,YAAAA,CAAOkB,IAAA,CAAAA,SAAAA,CAAPlB,CAAOkB,CAAPlB,CADqBmB,CAErBP,GAAQkB,CAAAA,CAAR,CAAAlB,CAAAA,CACA3B,GAAAA,KAAAA,CAAAA,CACEe,IAAM,GAAAwB,CAAAA,CAAA,CAANxB,CAAAA,CAAMwB,CAAA,CAAAM,CAAA,CAAN9B,MAAAA,CAAMwB,CAANxB,EAAAA,CACMA,KAAAA,CAAAA,EAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,YAAAA,GAAJ,CADFA,GAAMA,CAAA,CAAAA,kCAANA,CADFY,CAAAA,GACEZ,CAIHf,MAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAA,CACFe,IAAA,CAAA,CAGK,GAAAA,CAHL,CADE,CAAAf,CAJGe,CA8BN6B,CAAAA,CAzEN5B,CAAAA,EAAAA,IAAAA,CA0Dc,UAAc,CACZD,KAAAA,CADY,EAEZf,KAAAA,CAAAA,2DAAAA,CAAAA,CAAAA,CAAAA,CAAAA,IAAAA,CACE2C,SAAAA,CAAAA,CAAO,CAAA,MAAEZ,CAAAA,CAAA,CAAF,IAAEA,EADX/B,CAAAA,EAAAA,IAAAA,CAAA,SAAA,CAAA,CAAA,CAGA2B,GAAKmB,GAAAA,CAAG,CAAHA,MAHL,GAIA9C,CAAO+C,CAAP/C,oCAJA,EAKQ,WAAA8C,GAAAA,CAAA,CAAAA,SALR,CAIA/B,CAAA,CAAAA,kCAJA,CASD,WAAA+B,GAAAA,CAAA,CAAAA,SATC,EAUH/B,CAAA,CAAAA,6BAVG,CAWLf,MAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAA0C,CAAA,CAAA1C,EAAAA,CAAA,CACM2C,OAAY,CAAA,oBADlB,CAAA3C,CAXK,EAcW8C,SAALA,GAAAA,CAAJ,CAAIA,SAdN,GAeFA,UAAAA,GAAAA,CAAUA,CAAVA,UAAAA,EAAA,SAAgBA,GAAAA,CAAA,CAAAA,SAfd,CAgBN/B,CAAA,CAAAA,kCAhBM,CAiBa+B,KAAAA,GAAAA,CAAnB,CAAmBA,UAAAA,EAAH,SAAhBA,GAAAA,CAAA,CAAAA,SAjBM,CAqDA/B,CAAI,CAAJA,2BArDA,CAkBN+B,eAAAA,GAAAA,CAAqB,CAArBA,UAAAA,EAAc,SAAOA,GAAAA,CAAA,CAAAA,SAlBf,CAmBC/B,CAAK,CAALA,0BAnBD,CAoBY+B,eAAAA,GAAAA,CAAV,CAAUA,UAAAA,EAAL,SAA6C5B,GAAAA,CAAtD,CAAsDA,SApBpD,CAqBIH,CAAG,CAAHA,8BArBJ,CAsBA+B,MAAAA,GAAAA,CAAA,CAAAA,UAAAA,EAAQ,SAARA,GAAAA,CAAA,CAAAA,SAtBA,CAuBA9C,CAAO+C,CAAP/C,mCAvBA,CAwBQ8C,WAAAA,GAAAA,CAAA,CAAAA,UAAAA,EAAA,SAAAA,GAAAA,CAAA,CAAAA,SAxBR,GAyBI/B,CAAIA,CAAJA,sBAzBJ,CAwBQf,MAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAA0C,CAAA,CAAA1C,EAAAA,CAAA,CADR2C,OAAA,CAAA,8BACQ,CAAA3C,CAxBR,EAAAA,CAAAA,CAFY,CAoCtBA,MAAI2B,CAAJ3B,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAqB,CACnB4C,IAAM,CAAA,CACM,GAAA7B,CADN,CADa,CAArBf,CApCsB,CAyCde,MAAAA,CAAAA,YAAAA,CAAAA,OAAAA,CAAAA,MAAAA,CAAOE,IAAA,CAAPF,GAAOE,EAAPF,CAnGdC,CAAAA,CAHEY,KA2IK,CAlCK,GAAAD,CAAAA,CAAA,GAAA,CACEZ,MAAAA,CAAAA,GAAAA,CAAAA,GAAAA,CAAAA,WAAAA,CAAO,SAAA,CAAA,CAAA,CAEPA,OAHFuB,CAAAA,CAEWQ,CAAAA,IAAKE,CAALF,KAAAA,CAAV,CAAUA,CACT/B,CAAAA,CAAI,CAAJA,CAAAA,CAAOoB,CAAA,CAAAG,CAAA,CAAAH,MAAAA,EAAPpB,KAAAA,CAAAA,CAAAoB,CAAApB,EAAAA,CACAf,KAAAA,CAAAA,EAAAsC,CAAoBW,CAApBX,CAAoBW,CAApBX,CAAAA,YAAAA,GAAAtC,CADAe,GAEE4B,CAAAA,CAAAA,6BAFF5B,CACwCf,MAAxC,CAAwCA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAxC0C,CAAA,CAAwC1C,EAAAA,CAAxC,CAFK2C,OAKA,CAAIG,oBAHT,CAAwC9C,CADxCe,CAMEA,CAAAA,GANFA,CAOCf,MAFD,CAECA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAA8B,CAC7Be,IAAAA,CAAI,CADC,GAAAA,CACD,CADyB,CAA9Bf,CAPDe,EAcEA,MAAAA,CAAAA,GAAAA,CAAAA,GAAAA,CAAAA,WAAAA,CAAO,SAAA,CAAA,CAAA,CAEPA,OAHKmB,CAAAA,CAEIY,CAAAA,IAAKI,CAALJ,KAAAA,CAAV,CAAUA,CACT/B,CAAAA,CAAI,CAAJA,CAAAA,CAAOwB,CAAA,CAAAL,CAAA,CAAAK,MAAAA,EAAPxB,KAAAA,CAAAA,CAAAwB,CAAAxB,EAAAA,CACAf,KAAAA,CAAAA,EAAAkC,CAAoBe,CAApBf,CAAoBe,CAApBf,CAAAA,YAAAA,GAAAlC,CADAe,GAEE4B,CAAAA,CAAAA,kCAFF5B,CACwCY,CAAAA,GADxCZ,CAIDf,MAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAA,CACFe,IAAA,CAAA,CA/BL,GAAAA,CA+BK,CADE,CAAAf,CAJCe,EAUNf,MAAIe,CAAJf,GAAAA,CAAAA,GAAAA,CAAAA,YAAAA,CAAIe,SAAAA,CAAAA,CAAAA,CAFR,OACQ8B,CAAAA,CAAA,CAAAZ,IAAA,CAAAA,KAAAA,CAAA,CAAAA,CADR,CAAAM,CAAA,CAAA,CAAA,CAAAA,CAAA,CAAAM,CAAA,CAAAN,MAAAA,EAAA,KAAA,CAAA,CAAAA,CAAA,EAAA,CAKOH,KAAAA,CAAAA,EAAqBS,CAAQ5B,CAAR4B,CAAQ5B,CAAR4B,CAAAA,YAAAA,GAAtB,CALN,GAhGJ9B,CAAA,CAAAA,kCAgGI,CAOCY,CAAAA,GAPD,CAQJ3B,MAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAA,CACSe,IAAG,CAAZ,CACA,GAAeA,CADf,CADA,CAAAf,CARI,EAeEA,KAAAA,CAbMe,EAcJ4B,KAAAA,CAAAA,2DAAAA,CAAAA,CAAAA,CAAAA,CAAAA,IAAAA,CADF,SAAA,CAAA,CAAA,CAAA,MAAAZ,CAAAA,CAAA,CAAA,IAAAA,EACEY,CAAAA,EAAAA,IAAAA,CAEM,SAAA,CAAA,CAAR,CACM,GAACI,GAAAA,CAAP,CAAOA,MADP,GAEQhC,CAAA,CAAAA,oCAFR,EAMD,WAAA+B,GAAAA,CAAA,CAAAA,SANC,CAOH/B,CAAA,CADE,kCANC,CAQW,WAAA+B,GAAAA,CAAA,CAAAA,SARX,EASIZ,CAAS,CAATA,6BATJ,CAUQlC,MAAMuC,CAANvC,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAA8B2B,CAAAA,CAA9B3B,EAAAA,CAAmC,CAClC2C,OAAK,CAAA,oBAD6B,CAAnC3C,CAVR,EAcS+C,SAAQI,GAAAA,CAAAA,CAAAA,SAdjB,GAeUL,UAAAA,GAAAA,CAAA,CAAAA,UAAAA,EAAF,SAAEA,GAAAA,CAAA,CAAAA,SAfV,CAgBU/B,CAAAA,CAAAA,kCAhBV,CAeU+B,KAAAA,GAAAA,CAAA,CAAAA,UAAAA,EAAA,SAAAA,GAAAA,CAAA,CAAAA,SAfV,CAcE/B,CAAA,CAAAA,8BAdF,CAmBC+B,eAAAA,GAAAA,CAAA,CAAAA,UAAAA,EAAA,SAAAA,GAAAA,CAAA,CAAAA,SAnBD,CAoBD/B,CAAA,CAAAA,iCApBC,CA6DmB+B,eAAAA,GAAAA,CAAI,CAAJA,UAAAA,EAAJ,SAA2CA,GAAAA,CAAI,CAAJA,SA7D1D,CAqBSjC,CAAI,CAAJA,8BArBT,CAsBmBoB,MAAAA,GAAAA,CAAKmB,CAALnB,UAAAA,EAAH,SAAhBa,GAAAA,CAAA,CAAAA,SAtBA,CAgEU/B,CAAI,CAAJA,8BAhEV,CAuBiB+B,WAAAA,GAAAA,CAAGD,CAAHC,UAAAA,EAAjB,SAAmDA,GAAAA,CAAnD,CAAmDA,SAvBnD,GAwBMnB,CAAK,CAALA,6BAxBN,CAyBQ3B,MAAG,CAAHA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAG0C,CAAP,CAAI1C,EAAAA,CAAJ,CACK2C,OAAL,CAAA,8BADA,CAAI3C,CAzBR,GA4BYA,MAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAA,CADRe,IAAA,CAAA,CAKD,GAAAA,CALC,CACQ,CAAAf,CA9BV2C,CAAAA,CAdA3C,CAAAA,CAZMe,CAAAA,CAhBFA,CAAAA,CAiCP,CAkDOf,MAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAyB,CACvBe,IAAAA,CAAAA,CACD,GAAAA,CADCA,CADuB,CAAzBf,CAgDb,CA3Ca,CAGC,IAAAgB,EAAAA,CAxMZ,EAkNcD,CAAA,CAAAA,gCAlNd,CAmNeA,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAO,CACRA,IAAA,CAAA,CACCA,GAAAA,CADD,CADQ,CAAPA,CAnNf,GAyMaA,CAAAA,CAAAA,oCAzMb,CA2Maf,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,OAAAA,CAAoBiD,CAClBN,IAAAA,CAAAA,CADsC,GAAA5B,CACtC4B,CADkBM,CAApBjD,CA3Mb,CAyNee,CACD,CAECf,MAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAAA,WAAAA,CAAoBiD,UAAoB,CACtCN,MAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAAA,IAAAA,CAAS,SAAA,CAAA,CAAA,CAD6BU,aAAA,CAAA,CAAA,CAAAX,CAAxC,CAAwCW,GAAA,CACtCV,CAAAA,CADF3C,CAAAA,C,CAKJA,MAAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,SAAAA,CAAAA,WAAAA,CAAemD,SAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAsB,CACnCpC,aAAAA,CAAAA,CAAAA,CAAAA,CAAAA,CAAAA,GAAAA,CADFf,CAAAA,C,CAKDA,MAAA,CAAAA,OAAAA,CAAAA,OAAAA,CAAAA,SAAAA,CAAAA,WAAAA,CAzCH,UAAA,CA0CDA,MAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,WAAAA,CAAAA,IAAAA,CAAA,SAAA,CAAA,CAAA,CACFqD,aA1DD,CAAA,CAAA,CAAAX,CAAA,CA0DCW,GA1DD,CAyDGrD,CAAAA,CADIA,CAAAA,C,CAMTe,MAAAA,CAAAA,OAAAA,CAAAA,OAAAA,CAAAA,WAAAA,CAAAA,WAAAA,CAAM,UAAA,CACJf,MAAA,CAAAA,OAAAA,CAAAA,IAAAA,CAAAA,MAAAA,CAAIe,CAAAA,GAAAA,CAAAA,MAAAA,CAAAA,OAAAA,CAAAA,SAAAA,CAAAA,MAAAA,CAAAA,sBAAAA,CAAAA,CAAJf,CAAIe,UAAAA,CAAJf,CAAAA,CADFe,CAAAA,C","file":"background.min.js","sourcesContent":["// #############################################################################\n// HELPERS\n\n// Detect and return browser api\n\nwindow.browser = (function () {\n  return window.msBrowser ||\n    window.browser ||\n    window.chrome;\n})();\n\n// HELPER OR INDEX DB\n/*eslint-disable */\n\n//suppress all warnings between comments\n!function(){function e(t,o){return n?void(n.transaction(\"s\").objectStore(\"s\").get(t).onsuccess=function(e){var t=e.target.result&&e.target.result.v||null;o(t)}):void setTimeout(function(){e(t,o)},100)}var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;if(!t)return void console.error(\"indexDB not supported\");var n,o={k:\"\",v:\"\"},r=t.open(\"d2\",1);r.onsuccess=function(e){n=this.result},r.onerror=function(e){console.error(\"indexedDB request error\"),console.log(e)},r.onupgradeneeded=function(e){n=null;var t=e.target.result.createObjectStore(\"s\",{keyPath:\"k\"});t.transaction.oncomplete=function(e){n=e.target.db}},window.ldb={get:e,set:function(e,t){o.k=e,o.v=t,n.transaction(\"s\",\"readwrite\").objectStore(\"s\").put(o)}}}();\n/* eslint-enable */\n\n// #############################################################################\n// CHECK IF PAGE IS A FAKE SHOP\n\nfunction checkFakeShop (tab, url) {\n  if (url) {\n    let path = \"img/action/action-disabled.png\";\n    const disabled_time = localStorage.getItem(\"disabled_time\");\n    const disable_offset = (15 * 60 * 1000);\n\n    // CHECK IF PlUGIN IS TEMPORARILY DISABLED\n    if (disabled_time == null || disabled_time < (Date.now() - disable_offset)) {\n      if (!url.startsWith(\"chrome://\") && !url.startsWith(\"about://\")) {\n        // CLEAN UP URL\n        url = new URL(url);\n\n        // PREPARATION FOR POST CALL\n\n        // CHECK IF ID IS SAVED IN LOCALSTORAGE IF NOT GENERATE A NEW ONE\n        var client_id = window.localStorage.getItem(\"client_id\");\n        if (client_id == null) {\n          client_id = Math.random().toString(36).substr(2, 9);\n          window.localStorage.setItem(\"client_id\", client_id);\n        }\n        const optional_params = {\n          method: \"POST\",\n          // eslint-disable-next-line\n          body: JSON.stringify({\"site_baseURL\": url, \"clientID\": client_id}),\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          auth_clinetId: \"1\",\n        };\n        // PREPARE URL FOR INDEXDB DATA\n        url = url.hostname;\n        url = url.replace(\"www.\", \"\");\n        // GET DATE FROM LOCAL STORAGE END CHECK IF IT IS OLDER THAN ONE DAY\n        const date = window.localStorage.getItem(\"date\");\n        var one_day = (24 * 60 * 60 * 1000);\n        var found = false;\n\n        // INIT INDEXDB WITH DATA\n        if (date == null || one_day < (Date.now() - date)) {\n          // eslint-disable-next-line no-undef\n          fetch(\"https://mal2.ait.ac.at/fake-shop-detector/api/1.1/whitelist?all=true\")\n            .then(data => data.json())\n            .then(function (json) {\n              window.ldb.set(\"whitelist\", JSON.stringify(json));\n              const whitelist = json;\n              for (var j = 0; j < whitelist.length; j++) {\n                if (found === false && whitelist[j].site_baseURL === url) {\n                  path = \"img/action/action-successful.png\";\n                  found = true;\n                  window.browser.browserAction.setIcon({\n                    path: {\n                      32: path,\n                    },\n                  });\n                }\n              }\n            })\n            .then(\n              fetch(\"https://mal2.ait.ac.at/fake-shop-detector/api/1.1/blacklist?all=true\")\n                .then(data => data.json())\n                .then(function (json) {\n                  window.ldb.set(\"blacklist\", JSON.stringify(json));\n                  const blacklist = json;\n                  if (found === false) {\n                    for (var i = 0; i < blacklist.length && found === false; i++) {\n                      if (found === false && blacklist[i].site_baseURL === url) {\n                        path = \"img/action/action-disabled.png\";\n                        window.browser.tabs.sendMessage(tab.id, {\n                          command: \"show_fraud_warning\",\n                        });\n                        found = true;\n                        window.browser.browserAction.setIcon({\n                          path: {\n                            32: path,\n                          },\n                        });\n                      }\n                    }\n                  }\n                })).then(function () {\n              fetch(\"https://mal2.ait.ac.at/fake-shop-detector/api/1.1/ignorelist?all=true\")\n                .then(data => data.json())\n                .then(function (json) {\n                  window.ldb.set(\"ignorelist\", JSON.stringify(json));\n                  const ignorelist = json;\n                  if (found === false) {\n                    for (var i = 0; i < ignorelist.length; i++) {\n                      if (found === false && ignorelist[i].site_baseURL === url) {\n                        path = \"img/action/action-ingorelist.png\";\n                        found = true;\n                        window.browser.browserAction.setIcon({\n                          path: {\n                            32: path,\n                          },\n                        });\n                      }\n                    }\n                  }\n                });\n            })\n            .then(function () {\n              if (found === false) {\n                fetch(\"https://mal2.ait.ac.at/fake-shop-detector/api/1.1/analyze\", optional_params)\n                  .then(data => data.json())\n                  .then(function (json) {\n                    if (json.status === 400) {\n                      path = \"img/action/action-not-analyzed.png\";\n                    }\n                    // Assign right icon\n                    if (json.processor === \"whitelist\") {\n                      path = \"img/action/action-successful.png\";\n                    } else if (json.processor === \"blacklist\") {\n                      path = \"img/action/action-fraud.png\";\n                      window.browser.tabs.sendMessage(tab.id, {\n                        command: \"show_fraud_warning\",\n                      });\n                    } else if (json.processor === \"mal2_ai\") {\n                      if (json.risk_score === \"very low\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/action-successful.png\";\n                      } else if (json.risk_score === \"low\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/action-low.png\";\n                      } else if (json.risk_score === \"below average\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/above-avg.png\";\n                      } else if (json.risk_score === \"above average\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/action-medium.png\";\n                      } else if (json.risk_score === \"high\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/action-maybe-fraud.png\";\n                      } else if (json.risk_score === \"very high\" && json.processor === \"mal2_ai\") {\n                        path = \"img/action/fraud.png\";\n                        window.browser.tabs.sendMessage(tab.id, {\n                          command: \"show_potential_fraud_warning\",\n                        });\n                      }\n                    }\n                  });\n              }\n              window.browser.browserAction.setIcon({\n                path: {\n                  32: path,\n                },\n              });\n              window.localStorage.setItem(\"date\", Date.now());\n            });\n        } else {\n          // USE DATA FROM INDEXDB\n          let found = false;\n          window.ldb.get(\"blacklist\", function (value) {\n            const blacklist = JSON.parse(value);\n            for (var j = 0; j < blacklist.length && found === false; j++) {\n              if (found === false && blacklist[j].site_baseURL === url) {\n                path = \"img/action/action-fraud.png\";\n                window.browser.tabs.sendMessage(tab.id, {\n                  command: \"show_fraud_warning\",\n                });\n                found = true;\n                window.browser.browserAction.setIcon({\n                  path: {\n                    32: path,\n                  },\n                });\n              }\n            }\n            window.ldb.get(\"whitelist\", function (value) {\n              const whitelist = JSON.parse(value);\n              for (var i = 0; i < whitelist.length && found === false; i++) {\n                if (found === false && whitelist[i].site_baseURL === url) {\n                  path = \"img/action/action-successful.png\";\n                  found = true;\n                  window.browser.browserAction.setIcon({\n                    path: {\n                      32: path,\n                    },\n                  });\n                }\n              }\n              window.ldb.get(\"ignorelist\", function (value) {\n                const ignorelist = JSON.parse(value);\n                for (var i = 0; i < ignorelist.length && found === false; i++) {\n                  if (found === false && ignorelist[i].site_baseURL === url) {\n                    path = \"img/action/action-ingorelist.png\";\n                    found = true;\n                    window.browser.browserAction.setIcon({\n                      path: {\n                        32: path,\n                      },\n                    });\n                  }\n                }\n                // IF URL NOT FOUND IN CACHED DATA MAKE ANALYZE CALL\n                if (found === false) {\n                  fetch(\"https://mal2.ait.ac.at/fake-shop-detector/api/1.1/analyze\", optional_params)\n                    .then(data => data.json())\n                    .then(function (json) {\n                      if (json.status === 400) {\n                        path = \"img/action/action-not-analyzed.png\";\n                      }\n                      // Assign right icon\n                      // NO FAKE SHOP\n                      if (json.processor === \"whitelist\") {\n                        path = \"img/action/action-successful.png\";\n                        // FAKE SHOP\n                      } else if (json.processor === \"blacklist\") {\n                        path = \"img/action/action-fraud.png\";\n\n                        window.browser.tabs.sendMessage(tab.id, {\n                          command: \"show_fraud_warning\",\n                        });\n                        // MAYBE FAKE SHOP\n                      } else if (json.processor === \"mal2_ai\") {\n                        if (json.risk_score === \"very low\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-successful.png\";\n                        } else if (json.risk_score === \"low\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-medium.png\";\n                        } else if (json.risk_score === \"below average\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-above-avg.png\";\n                        } else if (json.risk_score === \"above average\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-medium.png\";\n                        } else if (json.risk_score === \"high\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-medium.png\";\n                        } else if (json.risk_score === \"very high\" && json.processor === \"mal2_ai\") {\n                          path = \"img/action/action-fraud.png\";\n                          window.browser.tabs.sendMessage(tab.id, {\n                            command: \"show_potential_fraud_warning\",\n                          });\n                        }\n                      }\n                      window.browser.browserAction.setIcon({\n                        path: {\n                          32: path,\n                        },\n                      });\n                    });\n                }\n              });\n            });\n          });\n          window.browser.browserAction.setIcon({\n            path: {\n              32: path,\n            },\n          });\n        }\n      }\n    }\n    if (disabled_time != null) {\n      path = \"img/action/action-not-analyzed.png\";\n      window.browser.browserAction.setIcon({\n        path: {\n          32: path,\n        },\n      });\n    } else {\n      path = \"img/action/action-disabled.png\";\n      window.browser.browserAction.setIcon({\n        path: {\n          32: path,\n        },\n      });\n    }\n  }\n}\n\nwindow.browser.tabs.onActivated.addListener(function (active_info) {\n  window.browser.tabs.getSelected(null, function (tab) {\n    checkFakeShop(tab, tab.url);\n  });\n});\n\nwindow.browser.tabs.onUpdated.addListener(function (tab_id, change_info, tab) {\n  checkFakeShop(tab, tab.url);\n});\n\n// Listen if POPUP.js changed disable status and act accordingly\nwindow.browser.runtime.onMessage.addListener(function () {\n  window.browser.tabs.getSelected(null, function (tab) {\n    checkFakeShop(tab, tab.url);\n  });\n});\n\nwindow.browser.runtime.onInstalled.addListener(function (object) {\n  window.browser.tabs.create({ url: window.browser.extension.getURL(\"options/options.html\") }, function (tab) {\n  });\n});\n"]}